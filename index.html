<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Portfolio</title>
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono:wght@400;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.8.0/vanilla-tilt.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>

  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'Noto Sans TC', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
          animation: { 
            'blob': 'blob 10s infinite',
            'fade-up': 'fadeUp 1s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
            'gradient-x': 'gradient-x 3s ease infinite',
            'ripple': 'ripple 0.6s linear forwards',
            'menu-pop': 'menuPop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards'
          },
          keyframes: { 
            blob: { '0%': { transform: 'translate(0px, 0px) scale(1)' }, '33%': { transform: 'translate(30px, -50px) scale(1.1)' }, '66%': { transform: 'translate(-20px, 20px) scale(0.9)' }, '100%': { transform: 'translate(0px, 0px) scale(1)' } },
            fadeUp: { '0%': { opacity: '0', transform: 'translateY(40px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
            'gradient-x': { '0%, 100%': { 'background-position': '0% 50%' }, '50%': { 'background-position': '100% 50%' } },
            ripple: { to: { transform: 'scale(4)', opacity: '0' } },
            menuPop: { '0%': { opacity: '0', transform: 'scale(0.9)' }, '100%': { opacity: '1', transform: 'scale(1)' } }
          }
        }
      }
    }
  </script>

  <!-- === MODULE: GLOBAL CSS === -->
  <style>
    /* 基礎設定 */
    body { 
      cursor: none; /* 電腦預設隱藏滑鼠 */
      background-color: #0a0a0a; 
      color: #f8fafc; 
      overflow-x: hidden; 
      -webkit-tap-highlight-color: transparent; /* 移除手機點擊高亮 */
    }
    
    /* 手機版恢復原生游標，隱藏自定義游標 */
    @media (hover: none) and (pointer: coarse) {
      body { cursor: auto; }
      .cursor-dot, .cursor-outline { display: none !important; }
      .dock-item, .ctx-item, a, button, .cursor-hover { cursor: pointer; }
    }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #0a0a0a; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    
    /* 極光背景 */
    .gradient-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; overflow: hidden; }
    .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4; animation: blob 10s infinite cubic-bezier(0.4, 0, 0.2, 1); }
    .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: #4f46e5; animation-delay: 0s; }
    .orb-2 { top: 20%; right: -10%; width: 40vw; height: 40vw; background: #10b981; animation-delay: 2s; }
    .orb-3 { bottom: -10%; left: 20%; width: 60vw; height: 60vw; background: #3b82f6; animation-delay: 4s; }

    /* Preloader */
    #preloader {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: #0a0a0a; z-index: 99999;
      display: flex; justify-content: center; align-items: center;
      transition: opacity 0.8s ease-in-out, visibility 0.8s;
    }
    .loader-content { text-align: center; }
    .loader-bar { width: 200px; height: 2px; background: #1e293b; margin-top: 20px; overflow: hidden; position: relative; }
    .loader-progress { position: absolute; top: 0; left: 0; height: 100%; width: 0%; background: #10b981; transition: width 0.3s; box-shadow: 0 0 10px #10b981; }

    /* 玻璃卡片 */
    .glass-card {
      background: rgba(255, 255, 255, 0.03);
      backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), background 0.3s;
      position: relative; overflow: hidden;
    }
    .glass-card::before {
      content: ""; position: absolute; height: 100%; width: 100%; top: 0; left: 0;
      background: radial-gradient(800px circle at var(--mouse-x) var(--mouse-y), rgba(255, 255, 255, 0.08), transparent 40%);
      z-index: 1; opacity: 0; transition: opacity 0.5s; pointer-events: none;
    }
    /* 手機上停用 hover 光暈，避免卡住 */
    @media (hover: hover) {
      .glass-card:hover::before { opacity: 1; }
      .glass-card:hover { border-color: rgba(255, 255, 255, 0.2); transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2); }
    }

    /* 游標 */
    .cursor-dot { width: 8px; height: 8px; background-color: white; position: fixed; top: 0; left: 0; transform: translate(-50%, -50%); border-radius: 50%; z-index: 9999; pointer-events: none; mix-blend-mode: difference; }
    .cursor-outline { width: 40px; height: 40px; border: 1.5px solid rgba(255, 255, 255, 0.5); position: fixed; top: 0; left: 0; transform: translate(-50%, -50%); border-radius: 50%; z-index: 9998; pointer-events: none; transition: width 0.2s, height 0.2s, background-color 0.2s; mix-blend-mode: difference; }
    body.hovering .cursor-outline { width: 60px; height: 60px; background-color: rgba(255, 255, 255, 0.2); border-color: transparent; }
    body.clicking .cursor-outline { transform: translate(-50%, -50%) scale(0.8); }

    /* 點擊水波紋 */
    .ripple {
      position: absolute; border-radius: 50%; transform: scale(0);
      border: 1px solid rgba(255, 255, 255, 0.5);
      animation: ripple 0.6s linear; pointer-events: none; z-index: 9997;
    }

    /* 磁吸按鈕 */
    .magnetic-btn { display: inline-flex; align-items: center; justify-content: center; transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); }

    /* 打字機與文字特效 */
    .typing-cursor::after { content: '|'; margin-left: 4px; animation: blink 1s infinite; color: #a78bfa; }
    @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
    .gradient-text-anim { background: linear-gradient(to right, #818cf8, #c084fc, #34d399); -webkit-background-clip: text; background-clip: text; color: transparent; background-size: 200% 200%; animation: gradient-x 3s ease infinite; }

    /* 跑馬燈 */
    .marquee-container { mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
    .marquee-content { animation: scroll 40s linear infinite; }
    @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

    /* 終端機 */
    #terminal-overlay { transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); transform: translateY(-100%); }
    #terminal-overlay.open { transform: translateY(0); }

    /* 懸浮 Dock (RWD 優化) */
    .floating-dock {
      position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
      background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(16px);
      border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 9999px;
      padding: 0.5rem 1rem; display: flex; gap: 0.5rem; z-index: 9000;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      transition: all 0.3s ease;
      max-width: 90vw; /* 防止手機超出 */
      overflow-x: auto; /* 極小螢幕可滾動 */
    }
    .dock-item {
      position: relative; width: 3rem; height: 3rem;
      display: flex; align-items: center; justify-content: center;
      border-radius: 50%; color: #94a3b8; transition: all 0.3s ease;
      flex-shrink: 0; /* 防止擠壓 */
    }
    @media (hover: hover) {
      .dock-item:hover { color: white; background: rgba(255, 255, 255, 0.1); transform: translateY(-5px); }
      .dock-item::after {
        content: attr(data-tooltip); position: absolute; bottom: 100%; left: 50%;
        transform: translateX(-50%) translateY(-10px); opacity: 0;
        background: rgba(0,0,0,0.8); color: white; padding: 4px 8px;
        border-radius: 4px; font-size: 10px; pointer-events: none;
        transition: all 0.2s; white-space: nowrap; margin-bottom: 8px;
      }
      .dock-item:hover::after { opacity: 1; transform: translateX(-50%) translateY(0); }
    }
    .dock-item:active { transform: scale(0.9); }

    /* 自定義右鍵選單 */
    #context-menu {
      position: absolute; display: none; z-index: 10001;
      width: 200px; background: rgba(15, 23, 42, 0.9); backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px;
      padding: 0.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      animation: menuPop 0.2s ease forwards;
    }
    .ctx-item {
      display: flex; align-items: center; gap: 10px;
      padding: 0.6rem 1rem; border-radius: 8px;
      color: #cbd5e1; font-size: 0.9rem; transition: all 0.2s;
    }
    .ctx-item:hover { background: rgba(16, 185, 129, 0.1); color: #10b981; }
    .ctx-divider { height: 1px; background: rgba(255,255,255,0.1); margin: 0.3rem 0; }
    .ctx-shortcut { margin-left: auto; font-size: 0.7rem; opacity: 0.5; }
  </style>
</head>
<body class="font-sans min-h-screen relative selection:bg-indigo-500 selection:text-white">

  <!-- ==================== CONFIGURATION ==================== -->
  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbw1J5DNcuCTfTGeQXhosPZYOW0MAfXDCNBHIi7rQTQMw7Nrfieuc4XEw0diuQkQ6XdUPg/exec";
  </script>
  <!-- ======================================================= -->

  <!-- 1. 優雅進場 Preloader -->
  <div id="preloader">
    <div class="loader-content">
      <div class="text-3xl font-bold text-white tracking-widest mb-2 font-mono">SYSTEM LOADING</div>
      <div class="text-xs text-slate-500 font-mono mb-4">INITIALIZING ASSETS...</div>
      <div class="loader-bar"><div class="loader-progress" id="loader-progress"></div></div>
    </div>
  </div>

  <!-- 背景特效 -->
  <div class="gradient-bg">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>
  
  <!-- UI 元件 -->
  <div id="scroll-progress" class="fixed top-0 left-0 h-[2px] bg-gradient-to-r from-indigo-500 via-purple-500 to-emerald-500 z-50 transition-all duration-100" style="width: 0%"></div>
  <div class="cursor-dot hidden md:block"></div>
  <div class="cursor-outline hidden md:block"></div>

  <!-- 隱藏終端機 -->
  <div id="terminal-overlay" class="fixed top-0 left-0 w-full h-1/2 bg-[#0f172a]/95 backdrop-blur-xl z-[10000] border-b border-indigo-500/30 shadow-2xl flex flex-col p-6 font-mono text-sm text-indigo-300 overflow-hidden">
    <div class="flex justify-between items-center mb-4 border-b border-indigo-500/20 pb-2 select-none">
      <span class="flex items-center gap-2"><i class="fas fa-terminal"></i> SECRET_TERMINAL_ACCESS</span>
      <span class="text-slate-500 text-xs">Press 'Ctrl + /' to close</span>
    </div>
    <div id="terminal-output" class="flex-1 overflow-y-auto space-y-1 pb-4">
      <div>> System initialized.</div>
      <div>> Type 'gravity' to start physics engine.</div>
    </div>
    <div class="flex items-center gap-2 text-white">
      <span class="text-indigo-400">visitor@portfolio:~$</span>
      <input type="text" id="terminal-input" class="bg-transparent border-none outline-none flex-1 font-mono text-white placeholder-slate-600" placeholder="Type command..." autocomplete="off">
    </div>
  </div>

  <!-- ★★★ 懸浮工具列 (Dock) - 手機版隱藏不需要的項目 ★★★ -->
  <div class="floating-dock">
    <div class="dock-item cursor-hover" data-tooltip="Home" onclick="window.scrollTo({top:0, behavior:'smooth'})">
      <i class="fas fa-home"></i>
    </div>
    <div class="dock-item cursor-hover" data-tooltip="Work" onclick="document.getElementById('links-container').scrollIntoView({behavior:'smooth'})">
      <i class="fas fa-layer-group"></i>
    </div>
    <div class="dock-item cursor-hover" data-tooltip="Skills" onclick="document.querySelector('.marquee-container').scrollIntoView({behavior:'smooth'})">
      <i class="fas fa-code"></i>
    </div>
    <div class="dock-item cursor-hover" data-tooltip="Terminal" onclick="toggleTerminal()">
      <i class="fas fa-terminal"></i>
    </div>
    <div class="dock-item cursor-hover" data-tooltip="Sound" id="dock-sound-btn">
      <i class="fas fa-volume-mute"></i>
    </div>
  </div>

  <!-- ★★★ 自定義右鍵選單 (手機版將被禁用) ★★★ -->
  <div id="context-menu">
    <div class="ctx-item cursor-hover" onclick="location.reload()">
      <i class="fas fa-sync-alt w-4"></i> Reload System
      <span class="ctx-shortcut">F5</span>
    </div>
    <div class="ctx-item cursor-hover" onclick="toggleTerminal()">
      <i class="fas fa-terminal w-4"></i> Open Terminal
      <span class="ctx-shortcut">^/</span>
    </div>
    <div class="ctx-divider"></div>
    <div class="ctx-item cursor-hover" onclick="initGravity()">
      <i class="fas fa-apple-alt w-4"></i> Gravity Mode
    </div>
    <div class="ctx-item cursor-hover" onclick="toggleSound()">
      <i class="fas fa-music w-4"></i> Toggle Sound
    </div>
  </div>

  <main id="main-content" class="relative z-10 max-w-6xl mx-auto px-6 py-24 pb-32">
    <!-- Header -->
    <div class="flex flex-col-reverse lg:flex-row items-center justify-between mb-32 gap-16 opacity-0 animate-fade-up" style="animation-delay: 0.2s;">
      <div class="text-center lg:text-left flex-1 space-y-8 physics-body">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 text-xs font-semibold tracking-wider text-indigo-300 bg-indigo-500/10 rounded-full border border-indigo-500/20 cursor-hover transition hover:bg-indigo-500/20">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-indigo-500"></span>
          </span>
          AVAILABLE FOR HIRE
        </div>
        <div class="space-y-4">
          <h1 class="text-4xl md:text-7xl lg:text-8xl font-extrabold tracking-tight text-white leading-tight">
            Hello, I'm <br/>
            <span id="site-title" class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 via-purple-400 to-emerald-400 cursor-hover">Loading...</span>
          </h1>
          <div class="text-lg md:text-2xl text-slate-400 font-light h-8 font-mono">
            > I am a <span id="typewriter" class="gradient-text-anim font-bold typing-cursor"></span>
          </div>
        </div>
        <p id="bio-text" class="text-base md:text-lg text-slate-400 max-w-lg mx-auto lg:mx-0 leading-relaxed">Fetching profile data...</p>
        <div id="social-links" class="flex gap-6 justify-center lg:justify-start pt-4 physics-body flex-wrap"></div>
      </div>

      <div class="relative group physics-body">
         <div class="absolute inset-0 bg-gradient-to-tr from-indigo-500 to-emerald-500 rounded-[2rem] blur-2xl opacity-40 group-hover:opacity-60 transition duration-700"></div>
         <div class="relative w-64 h-64 md:w-72 md:h-72 lg:w-96 lg:h-96 glass-card rounded-[2rem] p-3 overflow-hidden cursor-hover rotate-3 group-hover:rotate-0 transition duration-500">
            <img id="avatar-img" src="https://placehold.co/400x400/1e293b/FFF?text=..." class="w-full h-full rounded-[1.5rem] object-cover pointer-events-none">
         </div>
      </div>
    </div>

    <!-- 卡片連結區 -->
    <div class="mb-32 opacity-0 animate-fade-up" style="animation-delay: 0.4s;">
      <div class="flex items-center justify-between mb-8"> <!-- mb-12 -> mb-8 -->
        <h2 class="text-2xl font-bold text-white tracking-tight">Selected Work</h2> <!-- text-3xl -> text-2xl -->
        <div class="h-px bg-slate-800 flex-1 ml-8 opacity-50"></div>
      </div>
      <!-- grid-cols-1 保持單欄，但 gap 縮小 -->
      <div id="links-container" class="grid grid-cols-1 gap-6"> <!-- gap-8 -> gap-6 -->
        <div class="col-span-full text-center py-20">
          <div class="animate-spin w-10 h-10 border-4 border-indigo-500 border-t-transparent rounded-full inline-block"></div>
        </div>
      </div>
    </div>

    <!-- 技能牆 -->
    <div class="mb-20 py-12 opacity-0 animate-fade-up" style="animation-delay: 0.6s;">
      <p class="text-center text-slate-500 text-sm tracking-widest uppercase mb-8">Technologies</p>
      <div class="marquee-container overflow-hidden relative w-full">
        <div class="marquee-content flex gap-16 w-max items-center">
          <div class="flex gap-16 items-center text-4xl md:text-5xl text-slate-600">
            <i class="fab fa-html5 hover:text-orange-500 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-css3-alt hover:text-blue-500 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-js hover:text-yellow-400 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-react hover:text-cyan-400 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-vuejs hover:text-green-500 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-node hover:text-green-600 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-python hover:text-yellow-300 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-git-alt hover:text-orange-600 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
          </div>
          <!-- 重複 -->
          <div class="flex gap-16 items-center text-4xl md:text-5xl text-slate-600">
            <i class="fab fa-html5 hover:text-orange-500 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-css3-alt hover:text-blue-500 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-js hover:text-yellow-400 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-react hover:text-cyan-400 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-vuejs hover:text-green-500 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-node hover:text-green-600 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-python hover:text-yellow-300 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
            <i class="fab fa-git-alt hover:text-orange-600 transition duration-300 hover:-translate-y-2 cursor-hover"></i>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-center text-slate-500 text-sm pb-10 border-t border-slate-800/30 pt-8 opacity-0 animate-fade-up" style="animation-delay: 0.8s;">
      <p>&copy; <span id="year"></span> <span id="footer-name" class="text-slate-300">Me</span>. <span class="text-xs text-indigo-400/50 hidden md:inline">Ctrl+/ for terminal</span></p>
    </footer>
  </main>

  <!-- === MODULE: JAVASCRIPT === -->
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    let typingWords = ["Creative Developer", "Designer"]; 
    let isMuted = true;
    let audioCtx;
    let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

    // Preloader Logic
    function updateLoader(percent) {
      document.getElementById('loader-progress').style.width = percent + '%';
    }

    window.onload = function() {
      updateLoader(50); 
      if (!isMobile) initFluidCursor();
      initScrollProgress();
      initDock();       
      if (!isMobile) initContextMenu(); 
      initTerminal();
      if (!isMobile) initMagneticButtons(); 
      if (!isMobile) initSpotlightCards();  
      initClickRipple();
      fetchData().then(() => {
        updateLoader(100);
        setTimeout(() => {
          const preloader = document.getElementById('preloader');
          preloader.style.opacity = '0';
          preloader.style.visibility = 'hidden';
        }, 800); 
      });
    };

    async function fetchData() {
      try {
        const response = await fetch(`${API_URL}?type=api`);
        const result = await response.json();
        if (result.status === 'success') {
          renderSettings(result.settings);
          renderLinks(result.data);
        } else {
          document.getElementById('site-title').textContent = "Error";
        }
      } catch (error) {
        document.getElementById('site-title').textContent = "Offline";
      }
    }

    // === MODULE: RENDER & EFFECTS ===
    function renderSettings(s) {
      if(!s) return;
      document.title = s.site_title || 'Portfolio';
      
      const titleEl = document.getElementById('site-title');
      // 移除解碼特效相關邏輯
      titleEl.textContent = s.site_title || 'User';

      document.getElementById('footer-name').textContent = s.site_title || 'Me';
      document.getElementById('bio-text').textContent = s.bio_text || '';
      
      if(s.avatar_url) document.getElementById('avatar-img').src = s.avatar_url;
      if (s.site_subtitle) typingWords = s.site_subtitle.split(',').map(w => w.trim());
      startTypewriter();
      
      const social = document.getElementById('social-links');
      let html = '';
      const btnClass = "magnetic-btn w-12 h-12 rounded-full glass-card flex items-center justify-center text-slate-400 hover:text-white hover:bg-white/10 transition-colors cursor-hover text-xl";
      
      // 原有連結
      if(s.github_username) html += `<a href="https://github.com/${s.github_username}" target="_blank" class="${btnClass}" title="GitHub"><i class="fab fa-github"></i></a>`;
      if(s.instagram_url) html += `<a href="${s.instagram_url}" target="_blank" class="${btnClass}" title="Instagram"><i class="fab fa-instagram"></i></a>`;
      if(s.twitter_url) html += `<a href="${s.twitter_url}" target="_blank" class="${btnClass}" title="Twitter"><i class="fab fa-twitter"></i></a>`;
      if(s.linkedin_url) html += `<a href="${s.linkedin_url}" target="_blank" class="${btnClass}" title="LinkedIn"><i class="fab fa-linkedin"></i></a>`;
      
      // ★★★ 新增連結顯示邏輯 ★★★
      if(s.facebook_url) html += `<a href="${s.facebook_url}" target="_blank" class="${btnClass}" title="Facebook"><i class="fab fa-facebook"></i></a>`;
      if(s.youtube_url) html += `<a href="${s.youtube_url}" target="_blank" class="${btnClass}" title="YouTube"><i class="fab fa-youtube"></i></a>`;
      
      // Email 特別處理 mailto:
      if(s.email_address) html += `<a href="mailto:${s.email_address}" class="${btnClass}" title="Email"><i class="fas fa-envelope"></i></a>`;
      
      // 個人網站
      if(s.website_url) html += `<a href="${s.website_url}" target="_blank" class="${btnClass}" title="Website"><i class="fas fa-globe"></i></a>`;

      social.innerHTML = html;
      
      if(!isMobile) initMagneticButtons(); 
    }

    function renderLinks(data) {
      const container = document.getElementById('links-container');
      container.innerHTML = '';
      if (!data || data.length === 0) { 
        container.innerHTML = '<div class="col-span-full text-center text-slate-500">No content available</div>'; return; 
      }
      
      data.forEach((item, idx) => {
        // ★★★ 緊湊版卡片設計 ★★★
        // 1. 移除 min-h-[200px]
        // 2. 圖片寬度改為 md:w-1/4 (原本 2/5)
        // 3. padding 改為 p-6 (原本 p-8)
        const html = `
          <a href="${item.url}" target="_blank" 
             class="glass-card spotlight-card group relative flex flex-col md:flex-row rounded-xl overflow-hidden cursor-hover physics-body">
            
            <!-- 圖片：手機版 h-48, 電腦版寬度縮小為 1/4 -->
            <div class="h-48 md:h-auto md:w-1/4 relative overflow-hidden shrink-0 border-b md:border-b-0 md:border-r border-slate-700/50">
               <img src="${item.imageUrl || 'https://placehold.co/600x400/1e293b/FFF?text=Image'}" 
                    class="w-full h-full object-cover transition duration-700 group-hover:scale-105 pointer-events-none">
               <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0a] to-transparent opacity-60 pointer-events-none"></div>
            </div>
            
            <!-- 內容：Padding 縮小 -->
            <div class="flex-1 p-6 flex flex-col justify-center relative z-10">
              <div class="flex justify-between items-start mb-2">
                <!-- 標題字體縮小 -->
                <h3 class="text-xl font-bold text-white group-hover:text-indigo-300 transition">${item.title}</h3>
                <!-- 圖示縮小 -->
                <div class="w-8 h-8 rounded-full bg-white/5 flex items-center justify-center group-hover:bg-indigo-500 group-hover:text-white transition duration-300 shrink-0 ml-4">
                  <i class="fas fa-arrow-up-right text-xs transform group-hover:rotate-45 transition"></i>
                </div>
              </div>
              <p class="text-slate-400 text-sm leading-relaxed line-clamp-2 md:line-clamp-3">${item.description || ''}</p>
            </div>
          </a>
        `;
        container.insertAdjacentHTML('beforeend', html);
      });
      if(!isMobile) initSpotlightCards();
    }

    // === MODULE: GRAVITY ===
    let engine, runner, gravityTimeout;
    let isGravityActive = false;

    function initGravity() {
      if (isGravityActive) return;
      isGravityActive = true;

      // Add Exit Button
      const btn = document.createElement('button');
      btn.id = 'exit-gravity-btn';
      btn.className = 'fixed top-6 right-6 z-[10002] bg-red-600/90 hover:bg-red-500 text-white px-6 py-2 rounded-full font-mono font-bold shadow-[0_0_20px_rgba(220,38,38,0.5)] transition-all transform hover:scale-105 flex items-center gap-2 backdrop-blur-md';
      btn.innerHTML = '<i class="fas fa-power-off"></i> ABORT PHYSICS';
      btn.onclick = stopGravity;
      document.body.appendChild(btn);

      // Auto Reset
      gravityTimeout = setTimeout(stopGravity, 30000);

      // Physics Setup
      const Engine = Matter.Engine, World = Matter.World, Bodies = Matter.Bodies, Mouse = Matter.Mouse, MouseConstraint = Matter.MouseConstraint;
      engine = Engine.create();
      const elements = document.querySelectorAll('.physics-body');
      const bodies = [];
      
      elements.forEach(el => {
        const rect = el.getBoundingClientRect();
        // Store original styles
        el.dataset.origStyle = el.getAttribute('style') || ''; 
        
        const body = Bodies.rectangle(rect.left + rect.width / 2, rect.top + rect.height / 2, rect.width, rect.height, { restitution: 0.8, friction: 0.5 });
        body.domElement = el; bodies.push(body);
        
        el.style.position = 'fixed'; 
        el.style.width = rect.width + 'px'; 
        el.style.height = rect.height + 'px'; 
        el.style.zIndex = '9999';
        el.style.left = '0'; 
        el.style.top = '0';
        el.style.transform = `translate(${rect.left}px, ${rect.top}px)`;
      });

      // Walls
      const wallOptions = { isStatic: true, render: { visible: false } };
      let ground = Bodies.rectangle(window.innerWidth / 2, window.innerHeight + 50, window.innerWidth, 100, wallOptions);
      let wallL = Bodies.rectangle(-50, window.innerHeight / 2, 100, window.innerHeight, wallOptions);
      let wallR = Bodies.rectangle(window.innerWidth + 50, window.innerHeight / 2, 100, window.innerHeight, wallOptions);
      let ceiling = Bodies.rectangle(window.innerWidth / 2, -500, window.innerWidth, 100, wallOptions);

      World.add(engine.world, [ground, wallL, wallR, ceiling, ...bodies]);
      
      runner = Matter.Runner.create();
      Matter.Runner.run(runner, engine);

      // Update Loop
      function update() {
        if (!isGravityActive) return;
        bodies.forEach(b => {
          const el = b.domElement;
          if(el) {
             const x = b.position.x - el.offsetWidth / 2;
             const y = b.position.y - el.offsetHeight / 2;
             el.style.transform = `translate(${x}px, ${y}px) rotate(${b.angle}rad)`;
          }
        });
        requestAnimationFrame(update);
      }
      requestAnimationFrame(update);

      const mouseConstraint = MouseConstraint.create(engine, { element: document.body, mouse: Mouse.create(document.body) });
      World.add(engine.world, mouseConstraint);
    }

    function stopGravity() {
        if (!isGravityActive) return;
        isGravityActive = false;
        clearTimeout(gravityTimeout);

        const btn = document.getElementById('exit-gravity-btn');
        if (btn) btn.remove();

        if (runner) Matter.Runner.stop(runner);
        if (engine) Matter.Engine.clear(engine);

        document.querySelectorAll('.physics-body').forEach(el => {
            el.style = el.dataset.origStyle || ''; 
            el.style.transform = ''; 
        });
    }

    // === MODULE: CLICK RIPPLE ===
    function initClickRipple() {
      window.addEventListener('click', (e) => {
        const ripple = document.createElement('div');
        ripple.className = 'ripple';
        ripple.style.left = `${e.clientX}px`;
        ripple.style.top = `${e.clientY}px`;
        document.body.appendChild(ripple);
        for(let i=0; i<6; i++) createParticle(e.clientX, e.clientY);
        setTimeout(() => ripple.remove(), 600);
      });
    }
    function createParticle(x, y) {
      const p = document.createElement('div'); 
      p.style.cssText = `position:absolute; width:4px; height:4px; background:#10b981; border-radius:50%; pointer-events:none; z-index:9998; left:${x}px; top:${y}px;`;
      document.body.appendChild(p);
      const dx = (Math.random() - 0.5) * 100; const dy = (Math.random() - 0.5) * 100;
      p.animate([{ transform: 'translate(0,0)', opacity: 1 }, { transform: `translate(${dx}px, ${dy}px)`, opacity: 0 }], { duration: 600 }).onfinish = () => p.remove();
    }

    // === MODULE: UTILITIES ===
    function initMagneticButtons() {
      document.querySelectorAll('.magnetic-btn').forEach(btn => {
        btn.addEventListener('mousemove', (e) => {
          const r = btn.getBoundingClientRect();
          const x = e.clientX - r.left - r.width/2; const y = e.clientY - r.top - r.height/2;
          btn.style.transform = `translate(${x*0.3}px, ${y*0.3}px)`;
        });
        btn.addEventListener('mouseleave', () => btn.style.transform = 'translate(0,0)');
      });
    }

    function initSpotlightCards() {
      const cards = document.getElementsByClassName('spotlight-card');
      document.getElementById('links-container').onmousemove = e => {
        for (const c of cards) {
          const r = c.getBoundingClientRect();
          c.style.setProperty('--mouse-x', `${e.clientX - r.left}px`);
          c.style.setProperty('--mouse-y', `${e.clientY - r.top}px`);
        }
      };
    }

    function initFluidCursor() {
      const dot = document.querySelector('.cursor-dot'), outline = document.querySelector('.cursor-outline');
      let m = {x:0, y:0}, o = {x:0, y:0};
      window.addEventListener('mousemove', e => { m.x=e.clientX; m.y=e.clientY; dot.style.left=`${m.x}px`; dot.style.top=`${m.y}px`; });
      window.addEventListener('mousedown', () => document.body.classList.add('clicking'));
      window.addEventListener('mouseup', () => document.body.classList.remove('clicking'));
      const anim = () => {
        o.x += (m.x - o.x)*0.15; o.y += (m.y - o.y)*0.15;
        outline.style.left=`${o.x}px`; outline.style.top=`${o.y}px`;
        requestAnimationFrame(anim);
      };
      anim();
      new MutationObserver(ms => ms.forEach(m => { if(m.addedNodes.length) attachHover(); }))
        .observe(document.body, {childList:true, subtree:true});
      function attachHover() { document.querySelectorAll('a, button, .cursor-hover, .dock-item, .ctx-item').forEach(el => {
        el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
        el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
      }); }
      attachHover();
    }

    // === MODULE: DOCK & MENU ===
    function initDock() {
      const dockSoundBtn = document.getElementById('dock-sound-btn');
      dockSoundBtn.addEventListener('click', toggleSound);
    }

    function initContextMenu() {
      const menu = document.getElementById('context-menu');
      document.addEventListener('contextmenu', (e) => {
        e.preventDefault();
        const x = e.clientX; const y = e.clientY;
        const menuW = 200, menuH = 200;
        const finalX = x + menuW > window.innerWidth ? x - menuW : x;
        const finalY = y + menuH > window.innerHeight ? y - menuH : y;
        menu.style.left = `${finalX}px`; menu.style.top = `${finalY}px`; menu.style.display = 'block';
      });
      document.addEventListener('click', () => menu.style.display = 'none');
    }

    function toggleSound() {
      if (!audioCtx) audioCtx = new AudioContext();
      if (audioCtx.state === 'suspended') audioCtx.resume();
      isMuted = !isMuted;
      
      const icons = document.querySelectorAll('.fa-volume-mute, .fa-volume-up');
      icons.forEach(icon => {
        icon.className = isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up text-emerald-400';
      });
      
      if(!isMuted) playTone(600, 'sine', 0.1);
    }

    function toggleTerminal() {
      const overlay = document.getElementById('terminal-overlay');
      const input = document.getElementById('terminal-input');
      overlay.classList.toggle('open');
      if(overlay.classList.contains('open')) {
        input.focus();
        if(!isMuted && audioCtx) playTone(200, 'square', 0.2);
      }
    }

    function initAudio() {
      // Click only
      document.body.addEventListener('click', () => { if(!isMuted && audioCtx) playTone(800, 'triangle', 0.05); });
      // Hover (Desktop only)
      if (!isMobile) {
        document.body.addEventListener('mouseenter', e => {
          if(e.target.closest('.cursor-hover') || e.target.closest('a') || e.target.closest('.dock-item')) 
            if(!isMuted && audioCtx) playTone(300, 'sine', 0.05);
        }, true);
      }
    }

    function playTone(f,t,d) {
      if(!audioCtx) return;
      const o=audioCtx.createOscillator(), g=audioCtx.createGain();
      o.type=t; o.frequency.setValueAtTime(f, audioCtx.currentTime);
      g.gain.setValueAtTime(0.05, audioCtx.currentTime); g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime+d);
      o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+d);
    }

    function initTerminal() {
      const overlay=document.getElementById('terminal-overlay'), input=document.getElementById('terminal-input'), out=document.getElementById('terminal-output');
      let isOpen=false;
      document.addEventListener('keydown', e => {
        if(e.key === '/' && (e.ctrlKey || e.metaKey)) { e.preventDefault(); toggleTerminal(); }
      });
      input.addEventListener('keydown', e => {
        if(e.key==='Enter') { const c=input.value; input.value=''; printLog(`user@port:~$ ${c}`); process(c.trim().toLowerCase()); }
      });
      function printLog(h) { const d=document.createElement('div'); d.innerHTML=h; out.appendChild(d); out.scrollTop=out.scrollHeight; }
      function process(c) {
        let r='';
        switch(c) {
          case 'help': r='Commands: ls, cat, gravity, matrix, exit'; break;
          case 'ls': r='gravity_module.exe  secrets.txt'; break;
          case 'gravity': r='Activating Zero-G Physics Engine...'; setTimeout(initGravity, 1000); break;
          case 'matrix': r='Wake up, Neo...'; break;
          case 'exit': toggleTerminal(); break;
          default: r=`Unknown: ${c}`;
        }
        printLog(r);
      }
    }

    function startTypewriter() {
      const el=document.getElementById('typewriter'); let w=0, c=0, d=false;
      function type() {
        if(!typingWords.length) return;
        const txt = typingWords[w];
        el.textContent = txt.substring(0, d?c-1:c+1); d?c--:c++;
        let s = d?30:80;
        if(!d && c===txt.length) { d=true; s=2500; } else if(d && c===0) { d=false; w=(w+1)%typingWords.length; s=500; }
        setTimeout(type, s);
      }
      type();
    }

    function initScrollProgress() {
      const bar=document.getElementById('scroll-progress');
      window.addEventListener('scroll', () => {
        const s = document.documentElement.scrollTop || document.body.scrollTop;
        const h = document.documentElement.scrollHeight - document.documentElement.clientHeight;
        bar.style.width = `${(s/h)*100}%`;
      });
    }
  </script>
</body>
</html>
